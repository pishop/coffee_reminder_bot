{"version":3,"sources":["../src/commands.js"],"names":["bot","telegram","client","command","ctx","chatId","message","chat","id","regExp","result","exec","text","sendMessage","split","hours","minutes","timeString","getAsync","schedule","setAsync","res","find","t","push","sort","join","sendSticker","IntervalHelper","updateInterval","indexOf","filter","delAsync","schedulle"],"mappings":";;;;;;;;kBAEe,UAASA,GAAT,EAAcC,QAAd,EAAwBC,MAAxB,EAAgC;AAAA;;AAC3CF,QAAIG,OAAJ,CAAY,KAAZ;AAAA,2EAAmB,iBAAOC,GAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AACTC,kCADS,GACAD,IAAIE,OAAJ,CAAYC,IAAZ,CAAiBC,EADjB;AAETC,kCAFS,GAEA,2BAFA;AAGTC,kCAHS,GAGAD,OAAOE,IAAP,CAAYP,IAAIE,OAAJ,CAAYM,IAAxB,CAHA;;AAAA,kCAKX,CAACF,MAAD,IAAW,CAACA,OAAO,CAAP,CALD;AAAA;AAAA;AAAA;;AAMXT,qCAASY,WAAT,CAAqBR,MAArB,EAA6B,iBAA7B;AANW;;AAAA;AAAA,8CAUUK,OAAO,CAAP,EAAUI,KAAV,CAAgB,GAAhB,CAVV,yDAURC,KAVQ,wBAUDC,OAVC;;AAAA,kCAWXD,SAAS,CAAT,IAAcA,QAAQ,EAAtB,IAA4BC,WAAW,CAAvC,IAA4CA,WAAW,EAX5C;AAAA;AAAA;AAAA;;AAYLC,sCAZK,GAYWF,KAZX,SAYoBC,OAZpB;AAAA;AAAA,mCAaYd,OAAOgB,QAAP,CAAgBb,MAAhB,CAbZ;;AAAA;AAaLc,oCAbK;;AAAA,kCAePA,aAAa,IAfN;AAAA;AAAA;AAAA;;AAAA;AAAA,mCAgBDjB,OAAOkB,QAAP,CAAgBf,MAAhB,EAAwBY,UAAxB,CAhBC;;AAAA;AAAA;AAAA;;AAAA;AAkBDI,+BAlBC,GAkBKF,SAASL,KAAT,CAAe,GAAf,CAlBL;;AAAA,iCAmBHO,IAAIC,IAAJ,CAAS;AAAA,uCAAKC,MAAMN,UAAX;AAAA,6BAAT,CAnBG;AAAA;AAAA;AAAA;;AAoBHhB,qCAASY,WAAT,CAAqBR,MAArB,EAA6B,iBAA7B;AApBG;;AAAA;;AAwBPgB,gCAAIG,IAAJ,CAASP,UAAT;AAxBO;AAAA,mCAyBDf,OAAOkB,QAAP,CAAgBf,MAAhB,EAAwBgB,IAAII,IAAJ,GAAWC,IAAX,CAAgB,GAAhB,CAAxB,CAzBC;;AAAA;;AA4BXzB,qCAAS0B,WAAT,CAAqBtB,MAArB,EAA6B,gCAA7B;AACAuB,2DAAeC,cAAf,CAA8BxB,MAA9B,EAAsCH,MAAtC,EAA8CD,QAA9C;AA7BW;AAAA;;AAAA;AA+BXA,qCAASY,WAAT,CAAqBR,MAArB,EAA6B,iBAA7B;;AA/BW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAnB;;AAAA;AAAA;AAAA;AAAA;;AAmCAL,QAAIG,OAAJ,CAAY,QAAZ;AAAA,4EAAsB,kBAAOC,GAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AACZC,kCADY,GACHD,IAAIE,OAAJ,CAAYC,IAAZ,CAAiBC,EADd;AAEZC,kCAFY,GAEH,8BAFG;AAGZC,kCAHY,GAGHD,OAAOE,IAAP,CAAYP,IAAIE,OAAJ,CAAYM,IAAxB,CAHG;AAAA;AAAA,mCAIKV,OAAOgB,QAAP,CAAgBb,MAAhB,CAJL;;AAAA;AAIZc,oCAJY;;AAAA,kCAKd,CAACT,MAAD,IAAW,CAACA,OAAO,CAAP,CALE;AAAA;AAAA;AAAA;;AAMdT,qCAASY,WAAT,CAAqBR,MAArB,EAA6B,iBAA7B;AANc;;AAAA;AAAA,+CAUOK,OAAO,CAAP,EAAUI,KAAV,CAAgB,GAAhB,CAVP,0DAUXC,KAVW,wBAUJC,OAVI;;AAAA,kCAWdG,SAASW,OAAT,CAAoBf,KAApB,SAA6BC,OAA7B,MAA4C,CAAC,CAX/B;AAAA;AAAA;AAAA;;AAAA;AAAA,mCAYRd,OAAOkB,QAAP,CAAgBf,MAAhB,EAAwBc,SAASL,KAAT,CAAe,GAAf,EAAoBiB,MAApB,CAA2B;AAAA,uCAAKR,MAASR,KAAT,SAAkBC,OAAvB;AAAA,6BAA3B,EAA6DU,IAA7D,CAAkE,GAAlE,CAAxB,CAZQ;;AAAA;AAadzB,qCAAS0B,WAAT,CAAqBtB,MAArB,EAA6B,gCAA7B;AACAuB,2DAAeC,cAAf,CAA8BxB,MAA9B,EAAsCH,MAAtC,EAA8CD,QAA9C;AAdc;AAAA;;AAAA;AAgBdA,qCAASY,WAAT,CAAqBR,MAArB,EAA6B,iBAA7B;;AAhBc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAtB;;AAAA;AAAA;AAAA;AAAA;;AAoBAL,QAAIG,OAAJ,CAAY,OAAZ;AAAA,4EAAqB,kBAAOC,GAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACXC,kCADW,GACFD,IAAIE,OAAJ,CAAYC,IAAZ,CAAiBC,EADf;AAAA;AAAA,mCAEXN,OAAO8B,QAAP,CAAgB3B,MAAhB,CAFW;;AAAA;AAGjBJ,qCAAS0B,WAAT,CAAqBtB,MAArB,EAA6B,gCAA7B;AACAuB,2DAAeC,cAAf,CAA8BxB,MAA9B,EAAsCH,MAAtC,EAA8CD,QAA9C;;AAJiB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAArB;;AAAA;AAAA;AAAA;AAAA;;AAOAD,QAAIG,OAAJ,CAAY,MAAZ,EAAoB,eAAO;AACvB,YAAME,SAASD,IAAIE,OAAJ,CAAYC,IAAZ,CAAiBC,EAAhC;AACAP,iBAAS0B,WAAT,CAAqBtB,MAArB,EAA6B,gCAA7B;AACH,KAHD;AAIAL,QAAIG,OAAJ,CAAY,MAAZ;AAAA,4EAAoB,kBAAMC,GAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AACVC,kCADU,GACDD,IAAIE,OAAJ,CAAYC,IAAZ,CAAiBC,EADhB;AAAA;AAAA,mCAEQN,OAAOgB,QAAP,CAAgBb,MAAhB,CAFR;;AAAA;AAEV4B,qCAFU;;AAAA,kCAIZA,cAAc,IAJF;AAAA;AAAA;AAAA;;AAKZhC,qCAASY,WAAT,CAAqBR,MAArB,EAA6B,YAA7B;AALY;;AAAA;;AAShBJ,qCAASY,WAAT,CAAqBR,MAArB,EAA6B,cAAc4B,UAAUnB,KAAV,CAAgB,GAAhB,EAAqBY,IAArB,CAA0B,IAA1B,CAA3C;;AATgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAApB;;AAAA;AAAA;AAAA;AAAA;AAWH,C;;AAhFD","file":"commands.js","sourcesContent":["import { IntervalHelper } from './intervalHelper';\n\nexport default function(bot, telegram, client) {\n    bot.command('add', async (ctx) => {\n        const chatId = ctx.message.chat.id;\n        const regExp = /\\/add ([0-9]{2}:[0-9]{2})/;\n        const result = regExp.exec(ctx.message.text);\n\n        if (!result || !result[1]) {\n            telegram.sendMessage(chatId, 'Пиши нормально!');\n            return;\n        }\n\n        const [hours, minutes] = result[1].split(':');\n        if (hours >= 0 && hours < 24 && minutes >= 0 && minutes <= 59) {\n            const timeString = `${hours}:${minutes}`;\n            const schedule = await client.getAsync(chatId);\n\n            if (schedule === null) {\n                await client.setAsync(chatId, timeString);\n            } else {\n                const res = schedule.split('.');\n                if (res.find(t => t === timeString)) {\n                    telegram.sendMessage(chatId, 'Пиши нормально!');\n                    return;\n                }\n\n                res.push(timeString);\n                await client.setAsync(chatId, res.sort().join('.'));\n            }\n\n            telegram.sendSticker(chatId, 'CAADAgADnAADV08VCF49wTfBNSDPAg');\n            IntervalHelper.updateInterval(chatId, client, telegram);\n        } else {\n            telegram.sendMessage(chatId, 'Пиши нормально!');\n        }\n    });\n\n    bot.command('remove', async (ctx) => {\n        const chatId = ctx.message.chat.id;\n        const regExp = /\\/remove ([0-9]{2}:[0-9]{2})/;\n        const result = regExp.exec(ctx.message.text);\n        const schedule = await client.getAsync(chatId);\n        if (!result || !result[1]) {\n            telegram.sendMessage(chatId, 'Пиши нормально!');\n            return;\n        }\n\n        const [hours, minutes] = result[1].split(':');\n        if (schedule.indexOf(`${hours}:${minutes}`) !== -1) {\n            await client.setAsync(chatId, schedule.split('.').filter(t => t !== `${hours}:${minutes}`).join('.'));\n            telegram.sendSticker(chatId, 'CAADAgADmAADV08VCDNXeDKFVNRvAg');\n            IntervalHelper.updateInterval(chatId, client, telegram);\n        } else {\n            telegram.sendMessage(chatId, 'Пиши нормально!');\n        }\n    });\n\n    bot.command('clear', async (ctx) => {\n        const chatId = ctx.message.chat.id;\n        await client.delAsync(chatId);\n        telegram.sendSticker(chatId, 'CAADAgADoAADV08VCBicBX8exqU0Ag');\n        IntervalHelper.updateInterval(chatId, client, telegram);\n    });\n\n    bot.command('fast', ctx => {\n        const chatId = ctx.message.chat.id;\n        telegram.sendSticker(chatId, 'CAADAgADnwADV08VCMRycuQqC77iAg');\n    });\n    bot.command('list', async ctx => {\n        const chatId = ctx.message.chat.id;\n        const schedulle = await client.getAsync(chatId);\n\n        if (schedulle === null) {\n            telegram.sendMessage(chatId, 'Ничего нет');\n            return;\n        }\n\n        telegram.sendMessage(chatId, 'Пойдем в ' + schedulle.split('.').join(', '));\n    });\n}\n"]}